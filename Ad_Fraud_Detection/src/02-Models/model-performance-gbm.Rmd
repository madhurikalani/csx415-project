---
title: "model-performance-linear"
author: "Madhuri Kalani"
date: "April 21, 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


## Loading the Project

```{r p0, echo =FALSE, warning=FALSE}

setwd("C:/Users/akash/Documents/Madhuri stuff/Data_Science_Intro_R/Ad_Fraud_Detection")

library('ProjectTemplate')
load.project()

library('caret')



```

## Model Training using Gradient Boosting Algorithm

The caret package in R provides a powerful framework for classification.

```{r c1}

#Model to Classify - Gradient Boosting Algorithm


train_control <- trainControl(method="cv", number=3)

# train the model

model_gbm <- train(as.factor(is_attributed)~app + channel + ip +device + os + click_time, data=df.train, method="gbm", trControl=train_control)



# Results of Model Training
model_gbm

# Plotting the Trained Model
plot(model_gbm)


predict_svm <- predict(model_gbm, df.test)

# Confusion Matrix
print("Confusion Matrix for Gradient Boosting")
cm_gbm <- confusionMatrix(table(as.factor(df.test$is_attributed),predict_gbm))
cm_gbm

# Cohen's Kappa
print("kappa value for Gradient Boosting")
cm_gbm$overall[2]

# Accuracy
print("Accuracy value for Gradient Boosting")
cm_gbm$overall[1]

#ROC Curve
library(pROC)
plot(roc(df.test$is_attributed, as.numeric(predict_gbm), direction="<"),
      col="yellow", lwd=3, main="ROC Curve for GBM")


```


